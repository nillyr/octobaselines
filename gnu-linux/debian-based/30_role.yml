- id: 1
  name: Serveurs Web
  checkpoints:
  - id: 1
    title: Configuration Apache (manuel)
    description: >
      FIXME
    collection_cmd: >
      find /etc/apache2/ -type f -name *.conf -exec ls -ailL {} ;\ -exec cat {} \; > apache_config.txt;
      apachectl -t -D DUMP_MODULES > apache_modules.txt;
      apache2 -M > apache2_loaded_modules.txt;
      apache2ctl -M > apache2ctl_loaded_modules.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 2
    title: Configuration NGINX (manuel)
    description: >
      FIXME
    collection_cmd: >
      find /etc/nginx/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > nginx_config.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 3
    title: Configuration Lighttpd (manuel)
    description: >
      FIXME
    collection_cmd: >
      find /etc/lighttpd/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > lighttpd_config.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
- id: 2
  name: Proxy et Reverse Proxy
  checkpoints:
  - id: 1
    title: Configuration Squid (manuel)
    description: >
      FIXME
    collection_cmd: >
      find /etc/squid/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > squid_config.txt;
      find /etc/squid3/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > squid3_config.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 2
    title: Configuration NGINX (manuel)
    description: >
      FIXME
    collection_cmd: >
      find /etc/nginx/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > nginx_config.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 3
    title: Configuration Artica Proxy (manuel)
    description: >
      FIXME
      Un accès à l'interface graphique est possible.
      Voir aussi :
      * https://wiki.articatech.com/en/proxy-service
    collection_cmd: >
      find /etc/squid/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > artica_squid_config.txt;
      find /etc/squid3/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > artica_squid3_config.txt;
      find /etc/nginx/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > artica_nginx_config.txt;
      find /etc/artica-postfix/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > artica_config.txt;
      find /usr/share/artica-postfix/ -type f \( -name *.inc -o -name VERSION \) -exec ls -ailL {} ;\ -exec cat {} \; > artica_usr_share.txt;
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 4
    title: Configuration Olfeo (manuel)
    description: >
      FIXME
      Un accès à l'interface graphique est possible. Il est également possible d'auditer la solution en réalisant une sauvegarde depuis l'interface.
      Note : une sauvegarde génère des fichiers sql.
      Voir aussi :
      * https://www.olfeo.com/fr/documentation-technique
    collection_cmd: >
      find /opt/olfeo/ -type f \( -name *.conf -o -name *.cfg \) -exec ls -ailL {} ;\ -exec cat {} \; > olfeo_config.txt;
      find /opt/olfeo/ -type f -name *.sql -exec ls -ailL {} ;\ -exec cat {} \; > olfeo_sql.txt;
    collection_cmd_type: CMD_EXEC
    collect_only: true
- id: 3
  name: Load balancer
  checkpoints:
  - id: 1
    title: Load balancer - HAproxy (manuel)
    description: >
      FIXME
      Il n'y a pas grand chose à voir ici. Uniquement de la récolte.
    collection_cmd: >
      find /etc/haproxy/ -type f -exec ls -ailL {} ;\ -exec cat {} \; > haproxy_config.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
- id: 4
  name: Serveur DNS et DHCP
  checkpoints:
  - id: 1
    title: Serveur DNS (manuel)
    description: >
      FIXME
      Note : la collecte risque de ne pas marcher lorsque BIND est en chroot jail
    collection_cmd: >
      { cat /etc/named.conf; cat /etc/bind/named.conf; } > dns_bind_conf.txt;
      find /etc/bind/ -type f -name *.local -exec ls -ailL {} \; -exec cat {} \; > bind_zones_conf.txt;
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 2
    title: Serveur DHCP (manuel)
    description: >
      FIXME
    collection_cmd: >
      cat /etc/dhcp/dhcpd.conf > dhcp_conf.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
- id: 5
  name: Serveur de fichiers
  checkpoints:
  - id: 1
    title: Serveur NFS (manuel)
    description: >
      FIXME
    collection_cmd: >
      cat /etc/exports > exports.txt;
      cat /etc/idmapd.conf > nfs_domain_share.txt;
      cat /etc/fstab > mounted_share_fstab.txt;
      showmount -e > mounted_share_client.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 2
    title: Serveur Samba (manuel)
    description: >
      FIXME
    collection_cmd: >
      cat /etc/samba/smb.conf > share_smb.txt;
      cat /etc/fstab > mounted_share_fstab.txt;
      showmount -e > mounted_share_client.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 3
    title: Serveur VsFTPd (manuel)
    description: >
      FIXME
      Voir aussi :
      * https://linuxconfig.org/how-to-setup-vsftpd-on-debian
    collection_cmd: >
      { cat /etc/vsftpd.conf; cat /etc/vsftpd/vsftpd.conf; } > vsftpd_conf.txt;
      find /etc/vsftpd/ -type f -exec ls -ailL {} \; -exec cat {} \; > vsftpd_all_conf.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 4
    title: Serveur ProFTPd (manuel)
    description: >
      FIXME
    collection_cmd: >
      cat /etc/proftpd/proftpd.conf > proftpd_conf.txt;
      find /etc/proftpd/conf.d/ -type f -name *.conf -exec ls -ailL {} \; -cat {} \; > proftpd_conf_d.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
- id: 6
  name: Serveur d'authentification
  checkpoints:
  - id: 1
    title: LDAP (manuel)
    description: >
      FIXME
      Voir aussi :
      - https://wiki.debian.org/LDAP/OpenLDAPSetup
    collection_cmd: >
      find /etc/ldap/ -type f -exec ls -ailL {} \; -exec cat {} \; > ldap_conf.txt
      cat /etc/default/slapd > default_slapd_config.txt;
      slapcat > slapcat.txt;
      cat /etc/krb5.conf > kerberos.txt;
      find /etc/krb5kdc/ -type f -exec ls -ailL {} \; -exec cat {} \; > kdc_config.txt
    collection_cmd_type: CMD_EXEC
    collect_only: true
  - id: 2
    title: Samba-AD (manuel)
    description: >
      FIXME
      Note : les fichiers peuvent également être utilisés pour vérifier la configuration des partages
      Voir aussi :
      * https://www.server-world.info/en/note?os=Debian_10&p=samba&f=4
      * https://wiki.samba.org/index.php/Setting_up_Samba_as_an_Active_Directory_Domain_Controller
      * https://samba.tranquil.it/doc/fr/index.html
    collection_cmd: >
      cat /etc/samba/smb.conf > smb_conf.txt;
      samba-tool domain passwordsettings show > samba_domain_passpol.txt;
      samba-tool domain level show > samba_domain_level.txt
    collect_only: true
  - id: 3
    title: Solution Authelia (manuel)
    description: >
      FIXME
      La collecte ne pourra pas se faire si authelia se trouve dans un conteneur docker
      Voir aussi :
      * https://github.com/authelia/authelia
      * https://www.authelia.com/docs/
    collection_cmd: >
      find /etc/authelia/ -type f -exec ls -ailL {} \; -exec cat {} \; > authelia_config.txt
    collect_only: true
