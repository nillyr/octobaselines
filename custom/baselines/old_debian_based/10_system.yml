- id: 1
  name: Configuration matérielle
  checkpoints:
    - id: 1
      title: Architecture
      description: >
        L'utilisation d'une architecture 64 bits est préférable
      collection_cmd: arch > architecture.txt
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: Utilisation d'une architecture 64 bits
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; arch | grep -Eq "x86_64|amd64|aarch64" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.10
    - id: 2
      title: Jeu d'instruction AES
      description: >
        L'utilisation de processeurs prenant en charge le jeu d'intruction AES est recommandé.
      collection_cmd: cat /proc/cpuinfo > cpu_aes_flag.txt
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: AES-NI support
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -q aes /proc/cpuinfo && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2015/03/NP_ConfigMateriel.pdf#subsection.3.6
    - id: 3
      title: SMAP/SMEP
      description: >
        Les fonctions SMAP & SMEP ne doivent pas être désactivées.
      collection_cmd: cat /proc/cmdline > smap_smep.txt
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: SMAP active
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -q nosmap /proc/cmdline || PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2015/03/NP_ConfigMateriel.pdf#subsection.3.5
        - id: 2
          title: SMEP active
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -q nosmep /proc/cmdline || PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2015/03/NP_ConfigMateriel.pdf#subsection.3.4
    - id: 4
      title: Activation du service IOMMU (manuel)
      description: >
        Les fonctions SMAP & SMEP ne doivent pas être désactivées.
      collection_cmd: dmesg | grep -e DMAR -e IOMMU > iommu.txt
      collection_cmd_type: CMD_EXEC
      collect_only: true
    - id: 5
      title: Bit NX/XD
      description: >
        La fonction de contrôle d'accès en exécution d'une page mémoire doit être activée.
      collect_only: false
      checks:
        - id: 1
          title: Bit NX/XD actif
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; dmesg | grep "Execute Disable" | grep -v active || PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2015/03/NP_ConfigMateriel.pdf#subsection.4.4
    - id: 6
      title: Surveillance du système de fichiers
      description: >
        La vérification de l'intégrité du système de fichiers peut aider à détecter ou à prévenir les modifications illégitimes.
      collect_only: false
      checks:
        - id: 1
          title: Le paquet AIDE doit être installé
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; dpkg -s aide 2>/dev/null | grep -Eq "Status:\sinstall\sok\sinstalled" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: high
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.51
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.52
    - id: 7
      title: Contrôle d'accès au menu de configuration
      description: >
        L'accès au BIOS doit être protégé par un mot de passe.
      collection_cmd: '[ -e /boot/grub2/grub.cfg ] && GRUB_CONFIG_FILE=/boot/grub2/grub.cfg || GRUB_CONFIG_FILE=/boot/grub/grub.cfg; cat "${GRUB_CONFIG_FILE}" > grub_config_file.txt'
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: La valeur superusers est définie
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq "^set superusers" "${GRUB_CONFIG_FILE}" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: enhanced
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.17
            https://www.gnu.org/software/grub/manual/grub/grub.html#Security
            https://sleeplessbeastie.eu/2015/01/06/how-to-password-protect-grub-entries/
        - id: 2
          title: Les mots de passe ne sont pas en clair
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq "^password_pbkdf2" "${GRUB_CONFIG_FILE}" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: enhanced
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.17
            https://www.gnu.org/software/grub/manual/grub/grub.html#Security
            https://sleeplessbeastie.eu/2015/01/06/how-to-password-protect-grub-entries/
        - id: 3
          title: Un contrôle d'accès est défini
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq ".*--users\s" "${GRUB_CONFIG_FILE}" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: enhanced
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.17
            https://www.gnu.org/software/grub/manual/grub/grub.html#Security
            https://sleeplessbeastie.eu/2015/01/06/how-to-password-protect-grub-entries/
- id: 2
  name: Configuration système
  checkpoints:
    - id: 1
      title: Partitionnement
      description: >
        L'utilisation du partitionnementnement permet de protéger de d'isoler les différents composants du système de fichiers.
        Note : si la commande lsblk indique "sdaX  crypto" alors la partition est chiffrée. Voir dpkg pour le paquet "cryptsetup".
      collection_cmd: >
        mount > mount.txt;
        fdisk -l > fdisk.txt;
        lsblk --fs > lsblk.txt;
        { cat /etc/fstab; cat /etc/crypttab; } > mounted_disk.txt
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: Partition séparée pour /srv
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s+/srv\s+type.*" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 2
          title: Partition séparée pour /home
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s+/home\s+type.*" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 3
          title: Partition séparée pour /tmp
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s+/tmp\s+type.*" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 4
          title: Partition séparée pour /var
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s+/var\s+type.*" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 5
          title: Partition séparée pour /var/log
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s+/var/log\s+type.*" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 6
          title: Partition séparée pour /var/tmp
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s+/var/tmp\s+type.*" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
    - id: 2
      title: Partitionnement - options de montage
      description: >
        L'utilisation du partitionnementnement permet de protéger de d'isoler les différents composants du système de fichiers.
      collect_only: false
      checks:
        - id: 1
          title: Point de montage boot - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/boot\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 2
          title: Point de montage boot - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/boot\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 3
          title: Point de montage boot - noexec
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/boot\s.*\((\S+,)*noexec(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 4
          title: Point de montage boot - noauto
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/boot\s.*\((\S+,)*noauto(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: enhanced
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.13
        - id: 5
          title: Point de montage opt - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/opt\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 6
          title: Point de montage opt - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/opt\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 7
          title: Point de montage tmp - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/tmp\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 8
          title: Point de montage tmp - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/tmp\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 9
          title: Point de montage tmp - noexec
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/tmp\s.*\((\S+,)*noexec(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 10
          title: Point de montage srv - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/srv\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 11
          title: Point de montage srv - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/srv\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 12
          title: Point de montage home - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/home\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 13
          title: Point de montage home - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/home\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 14
          title: Point de montage home - noexec
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/home\s.*\((\S+,)*noexec(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 15
          title: Point de montage proc - hidepid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/proc\s.*\((\S+,)*hidepid=2(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 16
          title: Point de montage usr - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/usr\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 17
          title: Point de montage var - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 18
          title: Point de montage var - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 19
          title: Point de montage var - noexec
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var\s.*\((\S+,)*noexec(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 20
          title: Point de montage /var/log - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var/log\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 21
          title: Point de montage /var/log - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var/log\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 22
          title: Point de montage /var/log - noexec
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var/log\s.*\((\S+,)*noexec(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 23
          title: Point de montage /var/tmp - nosuid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var/tmp\s.*\((\S+,)*nosuid(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 24
          title: Point de montage /var/tmp - nodev
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var/tmp\s.*\((\S+,)*nodev(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
        - id: 25
          title: Point de montage /var/tmp - noexec
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; mount | grep -Eq ".*on\s/var/tmp\s.*\((\S+,)*noexec(\S+,?)*\)" && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.12
    - id: 3
      title: Systèmes de fichiers non nécessaires
      description: >
        La désactivation des systèmes de fichiers non nécessaires participe à la réduction de la surface d'attaque.
      collect_only: false
      checks:
        - id: 1
          title: Désactivation du montage de type freevxfs
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v freevxfs) == */bin/true* && -z $(lsmod | grep freevxfs) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
        - id: 2
          title: Désactivation du montage de type jffs2
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v jffs2) == */bin/true* && -z $(lsmod | grep jffs2) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
        - id: 3
          title: Désactivation du montage de type hfs
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v hfs) == */bin/true* && -z $(lsmod | grep hfs) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
        - id: 4
          title: Désactivation du montage de type hfsplus
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v hfsplus) == */bin/true* && -z $(lsmod | grep hfsplus) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
        - id: 5
          title: Désactivation du montage de type squashfs
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v squashfs) == */bin/true* && -z $(lsmod | grep squashfs) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
        - id: 6
          title: Désactivation du montage de type udf
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v udf) == */bin/true* && -z $(lsmod | grep udf) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
    - id: 4
      title: Montage de périphérique
      description: >
        La désactivation du montage automatique participe à la réduction de la surface d'attaque.
      collect_only: false
      checks:
        - id: 1
          title: Désactivation du montage automatique
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ ! $(dpkg -s autofs 2>&1 | grep -q 'is not installed') || ! $(systemctl show autofs.service -p UnitFileState | grep -v enabled) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
        - id: 2
          title: Désactivation des périphériques USB
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: "PASSING=0; [[ $(modprobe -n -v usb-storage) == */bin/true* && -z $(lsmod | grep usb-storage) ]] && PASSING=1; echo $PASSING"
          expected: 1
          verification_type: CHECK_EXACT
          level: high
          recommendation_on_failed: >
            FIXME_RECO
          see_also: https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.1
    - id: 5
      title: Espace disque suffisant (manuel)
      description: >
        L'absence d'espace disque suffisant peut impliquer un risque d'indisponibilité à court terme.
      collection_cmd: df -h > df.txt
      collection_cmd_type: CMD_EXEC
      collect_only: true
- id: 3
  name: Configuration sysctl
  checkpoints:
    - id: 1
      title: Paramétrage sysctl (manuel)
      description: >
        FIXME.
      collection_cmd: sysctl -a > variables_sysctl.txt
      collection_cmd_type: CMD_EXEC
      collect_only: true
    - id: 2
      title: Paramétrage sysctl - réseau
      description: >
        FIXME.
      collect_only: false
      checks:
        - id: 1
          title: Pas de routage entre les interfaces - net.ipv4.ip_forward
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.ip_forward
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 2
          title: Filtrage par chemin inverse - net.ipv4.conf.all.rp_filter
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.all.rp_filter
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 3
          title: Filtrage par chemin inverse - net.ipv4.conf.default.rp_filter
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.default.rp_filter
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 4
          title: Ne pas envoyer de redirections ICMP - net.ipv4.conf.all.send_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.all.send_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 5
          title: Ne pas envoyer de redirections ICMP - net.ipv4.conf.default.send_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.default.send_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 6
          title: Refuser les paquets de source routing - net.ipv4.conf.all.accept_source_route
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.all.accept_source_route
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 7
          title: Refuser les paquets de source routing - net.ipv4.conf.default.accept_source_route
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.default.accept_source_route
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 8
          title: Ne pas accepter les ICMP de type redirect - net.ipv4.conf.all.accept_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.all.accept_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 9
          title: Ne pas accepter les ICMP de type redirect - net.ipv4.conf.all.secure_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.all.secure_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 10
          title: Ne pas accepter les ICMP de type redirect - net.ipv4.conf.default.accept_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.default.accept_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 11
          title: Ne pas accepter les ICMP de type redirect - net.ipv4.conf.default.secure_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.default.secure_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 12
          title: Loguer les paquets ayant des IPs anormales - net.ipv4.conf.all.log_martians
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.conf.all.log_martians
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 13
          title: RFC 1337 - net.ipv4.tcp_rfc1337
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.tcp_rfc1337
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 14
          title: Ignorer les réponses non conformes à la RFC 1122 - net.ipv4.icmp_ignore_bogus_error_responses
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.icmp_ignore_bogus_error_responses
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 15
          title: Augmenter la plage pour les ports éphémères - net.ipv4.ip_local_port_range
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.ip_local_port_range
          expected: 32768 65535
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 16
          title: Utiliser les SYN cookies - net.ipv4.tcp_syncookies
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv4.tcp_syncookies
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 17
          title: Désactiver IPv6 - net.ipv6.conf.all.disable_ipv6
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.disable_ipv6
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 18
          title: Désactiver IPv6 - net.ipv6.conf.default.disable_ipv6
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.disable_ipv6
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 19
          title: Désactiver le support des "router solicitations" - net.ipv6.conf.all.router_solicitations
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.router_solicitations
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 20
          title: Désactiver le support des "router solicitations" - net.ipv6.conf.default.router_solicitations
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.router_solicitations
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 21
          title: Ne pas accepter les "router preferences" par "router advertisements" - net.ipv6.conf.all.accept_ra_rtr_pref
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.accept_ra_rtr_pref
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 22
          title: Ne pas accepter les "router preferences" par "router advertisements" - net.ipv6.conf.default.accept_ra_rtr_pref
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.accept_ra_rtr_pref
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 23
          title: Pas de configuration auto des prefix par "router advertisements" - net.ipv6.conf.all.accept_ra_pinfo
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.accept_ra_pinfo
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 24
          title: Pas de configuration auto des prefix par "router advertisements" - net.ipv6.conf.default.accept_ra_pinfo
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.accept_ra_pinfo
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 25
          title: Pas d'apprentissage du routeur par défaut par "router advertisements" - net.ipv6.conf.all.accept_ra_defrtr
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.accept_ra_defrtr
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 26
          title: Pas d'apprentissage du routeur par défaut par "router advertisements" - net.ipv6.conf.default.accept_ra_defrtr
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.accept_ra_defrtr
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 27
          title: Pas de configuration auto des adresses à partir des "router advertisements" - net.ipv6.conf.all.autoconf
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.autoconf
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 28
          title: Pas de configuration auto des adresses à partir des "router advertisements" - net.ipv6.conf.default.autoconf
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.autoconf
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 29
          title: Ne pas accepter les ICMP de type redirect - net.ipv6.conf.all.accept_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.accept_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 30
          title: Ne pas accepter les ICMP de type redirect - net.ipv6.conf.default.accept_redirects
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.accept_redirects
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 31
          title: Refuser les packets de source routing - net.ipv6.conf.all.accept_source_route
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.accept_source_route
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 32
          title: Refuser les packets de source routing - net.ipv6.conf.default.accept_source_route
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.accept_source_route
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 33
          title: Nombre maximal d'adresses autoconfigurées par interface - net.ipv6.conf.all.max_addresses
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.all.max_addresses
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
        - id: 34
          title: Nombre maximal d'adresses autoconfigurées par interface - net.ipv6.conf.default.max_addresses
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n net.ipv6.conf.default.max_addresses
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.22
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/networking/ip-sysctl.rst
    - id: 3
      title: Paramétrage sysctl - système
      description: >
        FIXME.
      collect_only: false
      checks:
        - id: 1
          title: Désactivation des sysrq - kernel.sysrq
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.sysrq
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/
            https://www.linuxtricks.fr/wiki/sysrq-ou-les-touches-magiques
        - id: 2
          title: Exécutables setuid non dumpable (coredump) - fs.suid_dumpable
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n fs.suid_dumpable
          expected: 0
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/fs.rst
        - id: 3
          title: Blocage du déréférencement des liens - fs.protected_symlinks
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n fs.protected_symlinks
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/fs.rst
        - id: 4
          title: Blocage du déréférencement des liens - fs.protected_hardlinks
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n fs.protected_hardlinks
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/fs.rst
        - id: 5
          title: Activation de l'ASLR - kernel.randomize_va_space
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.randomize_va_space
          expected: 2
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
        - id: 6
          title: Interdiction de mapper de la mémoire dans les adresses basses - vm.mmap_min_addr
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n vm.mmap_min_addr
          expected: 65536
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/vm.rst
        - id: 7
          title: Espace de choix plus grand pour les valeurs de PID - kernel.pid_max
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.pid_max
          expected: 65536
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
        - id: 8
          title: Obfuscation des adresses mémoire kernel - kernel.kptr_restrict
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.kptr_restrict
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
        - id: 9
          title: Restriction d'accès au buffer dmesg - kernel.dmesg_restrict
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.dmesg_restrict
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
        - id: 10
          title: Restreint l'utilisation du sous système perf - kernel.perf_event_paranoid
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.perf_event_paranoid
          expected: 2
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
        - id: 11
          title: Restreint l'utilisation du sous système perf - kernel.perf_event_max_sample_rate
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.perf_event_max_sample_rate
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
        - id: 12
          title: Restreint l'utilisation du sous système perf - kernel.perf_cpu_time_max_percent
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.perf_cpu_time_max_percent
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.23
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/sysctl/kernel.rst
            https://www.kernel.org/doc/html/latest/admin-guide/sysctl/kernel.html#perf-cpu-time-max-percent
    - id: 4
      title: Paramétrage sysctl - modules noyau
      description: >
        FIXME.
      collect_only: false
      checks:
        - id: 1
          title: Désactivation du chargement de nouveaux modules - kernel.modules_disabled
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.modules_disabled
          expected: 1
          verification_type: CHECK_EXACT
          level: enhanced
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.24
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/
        - id: 2
          title: Périmètre de débogage ptrace - kernel.yama.ptrace_scope
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.yama.ptrace_scope
          expected: 1|2
          verification_type: CHECK_REGEX
          level: enhanced
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.25
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/
            https://linux-audit.com/protect-ptrace-processes-kernel-yama-ptrace_scope/
        - id: 3
          title: Périmètre de débogage ptrace - kernel.yama.ptrace_scope
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: sysctl -n kernel.yama.ptrace_scope
          expected: 3
          verification_type: CHECK_EXACT
          level: high
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.25
            https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/
            https://linux-audit.com/protect-ptrace-processes-kernel-yama-ptrace_scope/
- id: 4
  name: Logiciels
  checkpoints:
    - id: 1
      title: Dépôts de logiciels (manuel)
      description: >
        Afin de limiter la surface d'attaque, seuls les composants strictement nécessaires au service rendu par l'équipement doivent être installés.
        Les composants installés doivent correctement être sélectionnés depuis des sources fiables.

        Voir aussi :
        -  https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.14
        -  https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.15
        -  https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.16
        -  https://www.wapt.fr/fr/doc-1.8/waptserver-install/debian/install-debian-wapt.html
      collection_cmd: >
        find /etc/apt/ -type f \( -name *.list -o -name *.sources \) -exec ls -ailL {} \; -exec cat {} \; > sources_list.txt;
        find /opt/wapt/ -type f -exec ls -ailL {} \; -exec cat {} \; > wapt_conf.txt
      collection_cmd_type: CMD_EXEC
      collect_only: true
    - id: 2
      title: Dépôts de logiciels (clés gpg)
      description: >
        Afin de limiter la surface d'attaque, seuls les composants strictement nécessaires au service rendu par l'équipement doivent être installés.
        Les composants installés doivent correctement être sélectionnés depuis des sources fiables.

        Voir aussi :
        -  https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.14
        -  https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.15
        -  https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.16
      collection_cmd: >
        find /etc/apt/apt.conf.d/ -type f -exec ls -ailL {} \; -exec cat {} \; > apt_all_config.txt;
        apt-key list > apt_key.txt
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: La rétrogradation des paquets n'est pas autorisée - allow-downgrades
          description: >
            La rétrogradation des paquets est une option dangeureuse puisqu'elle peut conduire à la destruction du système.
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq "^(([a-zA-Z:])*|\s*)allow-downgrades\s\"(1|true)\";" /etc/apt/apt.conf.d/* || PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.14
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.15
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.16
            https://manpages.debian.org/unstable/apt/apt-get.8.fr.html
        - id: 2
          title: L'absence d'authenticité des paquets n'est pas autorisée - AllowUnauthenticated
          description: >
            Tous les paquets doivent être authentifiés avant d'être installés sur le système.
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq "^(([a-zA-Z:])*|\s*)AllowUnauthenticated\s\"(1|true)\";" /etc/apt/apt.conf.d/* || PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: intermediary
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.14
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.15
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.16
            https://manpages.debian.org/unstable/apt/apt-get.8.fr.html
    - id: 3
      title: Redémarrage requis (manuel)
      description: >
        Certaines mises à jour demandent un redémarrage du système. Un redémarrage régulier est recommandé.
      collection_cmd: "[ -f /var/run/reboot-required ] && echo true > is_reboot_required.txt"
      collection_cmd_type: CMD_EXEC
      collect_only: true
    - id: 4
      title: Mises à jour de sécurité
      description: >
        Le paquet 'unattended-upgrades' peut permettre l'installation des mises à jour de sécurité de manière automatique.
        La configuration de ce dernier peut également permettre le redémarrage automatique de l'équipement. Cela doit être fait en fonction du contexte. Lorsque le redémarrage automatique ne peut être effectué, un redémarrage manuel doit intervenir.
      collection_cmd: >
        cat /etc/apt/apt.conf.d/50unattended-upgrades > unattended-upgrades.txt;
        cat /etc/apt/apt.conf.d/20auto-upgrades > auto-upgrades.txt;
        cat /etc/apt/apt.conf.d/10periodic > periodic.txt
      collection_cmd_type: CMD_EXEC
      collect_only: false
      checks:
        - id: 1
          title: Mises à jour de sécurité automatique
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq '^\s*\"${distro_id}.*\-security\";' /etc/apt/apt.conf.d/50unattended-upgrades && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.8
        - id: 2
          title: Installation régulière des mises à jour
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; grep -Eq '^APT\:\:Periodic\:\:Unattended-Upgrade' /etc/apt/apt.conf.d/20auto-upgrades && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.8
        - id: 3
          title: Service unattended-upgrades actif
          description: >
            FIXME_DESCRIPTION
          type: CMD_EXEC
          cmd: PASSING=0; systemctl show unattended-upgrades.service -p UnitFileState | grep -q enabled && PASSING=1; echo $PASSING
          expected: 1
          verification_type: CHECK_EXACT
          level: minimal
          recommendation_on_failed: >
            FIXME_RECO
          see_also: >
            https://www.ssi.gouv.fr/uploads/2016/01/linux_configuration-fr-v1.2.pdf#section*.8
    - id: 5
      title: Paquets installés (manuel)
      description: >
        Afin de limiter la surface d'attaque, seuls les composants strictement nécessaires au service rendu par l'équipement doivent être installés. À titre d'exemple, les paquests de développement sont généralement installés par défaut et peuvent ne pas être nécessaires.

        Voir aussi : https://www.debian.org/doc/manuals/securing-debian-manual/ch03s06.en.html
      collection_cmd: dpkg-query -l > packages_list.txt
      collection_cmd_type: CMD_EXEC
      collect_only: true
